name: Semgrep CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    # The branches below must be a subset of the branches above
    branches: [ "master" ]
  #schedule:
  #  - cron: '38 5 * * 3'
  
jobs:
  semgrep:
    name: semgrep/ci
    runs-on: ubuntu-latest
    env:
      SEMGREP_APP_TOKEN: ${{ secrets.SEMGREP_APP_TOKEN }}
    container:
      image: returntocorp/semgrep
    steps:
    - uses: actions/checkout@v4
    - run: semgrep ci

  Checkout:
    needs: semgrep 
    name: Checkout
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4.2.2
           
    - name: ZAP Full Scan
  # You may pin to the exact commit or the version.
  # uses: zaproxy/action-full-scan@75ee1686750ab1511a73b26b77a2aedd295053ed
      uses: zaproxy/action-full-scan@v0.12.0
      with:
    # GitHub Token to create issues in the repository
        token: ${{ github.token }}
    # Target URL
        target: 'http://host.docker.internal:8080/'
    # Relative path of the ZAP configuration file
    #    rules_file_name: # optional
    # The Docker file to be executed
        docker_name: 'ghcr.io/zaproxy/zaproxy:stable'
    # Additional command line options
        cmd_options: '-a'
    # The title for the GitHub issue to be created
    #    issue_title: # optional, default is ZAP Full Scan Report
    # The action status will be set to fail if ZAP identifies any alerts during the full scan
    #    fail_action: # optional
    # Whether Github issues should be created or not
    #    allow_issue_writing: # optional, default is true
    # The name of the artifact that contains the ZAP reports
    #    artifact_name: # optional, default is zap_scan
          
